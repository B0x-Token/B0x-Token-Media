<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Browser</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #24292e;
            color: white;
            padding: 20px;
            border-bottom: 3px solid #0366d6;
        }
        .header h1 {
            margin: 0;
            font-size: 24px;
            display: flex;
            align-items: center;
        }
        .header .repo-info {
            margin-top: 8px;
            opacity: 0.8;
            font-size: 14px;
        }
        .breadcrumb {
            padding: 15px 20px;
            background: #f1f8ff;
            border-bottom: 1px solid #c8e1ff;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', monospace;
        }
        .breadcrumb a {
            color: #0366d6;
            text-decoration: none;
        }
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        .file-list {
            padding: 0;
        }
        .file-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            border-bottom: 1px solid #e1e4e8;
            transition: background-color 0.2s;
        }
        .file-item:hover {
            background-color: #f6f8fa;
        }
        .file-item:last-child {
            border-bottom: none;
        }
        .file-icon {
            width: 16px;
            height: 16px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .file-name {
            flex: 1;
            margin-right: 20px;
        }
        .file-name a {
            color: #0366d6;
            text-decoration: none;
            font-weight: 500;
        }
        .file-name a:hover {
            text-decoration: underline;
        }
        .file-info {
            display: flex;
            gap: 20px;
            color: #586069;
            font-size: 12px;
            min-width: 200px;
        }
        .loading {
            padding: 40px;
            text-align: center;
            color: #586069;
        }
        .error {
            padding: 40px;
            text-align: center;
            color: #d73a49;
            background: #ffeef0;
            border: 1px solid #fdb8c0;
            margin: 20px;
            border-radius: 6px;
        }
        .folder-icon {
            fill: #79b8ff;
        }
        .file-icon-generic {
            fill: #586069;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <svg class="file-icon" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M2 2.5A2.5 2.5 0 014.5 0h8.75a.75.75 0 01.75.75v12.5a.75.75 0 01-.75.75h-2.5a.75.75 0 110-1.5h1.75v-2h-8a1 1 0 00-.714 1.7.75.75 0 01-1.072 1.05A2.495 2.495 0 012 11.5v-9zm10.5-1V9h-8c-.356 0-.694.074-1 .208V2.5a1 1 0 011-1h8zM5 12.25v3.25a.25.25 0 00.4.2l1.45-1.087a.25.25 0 01.3 0L8.6 15.7a.25.25 0 00.4-.2v-3.25a.25.25 0 00-.25-.25h-3.5a.25.25 0 00-.25.25z"></path>
                </svg>
                File Browser
            </h1>
            <div class="repo-info" id="repoInfo">Loading repository information...</div>
        </div>
        <div class="breadcrumb" id="breadcrumb">
            <a href="#" onclick="loadPath('')">üìÅ /</a>
        </div>
        <div id="fileList" class="loading">
            Loading files...
        </div>
    </div>

    <script>
        // Configuration - Update these values
        const GITHUB_USERNAME = 'B0x-Token';  // Replace with your GitHub username
        const GITHUB_REPO = 'B0x-Token-Media';    // Replace with your repository name
        const GITHUB_BRANCH = 'main';            // Usually 'main' or 'master'
        
        let currentPath = '';

        async function fetchGitHubAPI(path) {
            const url = `https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents/${path}?ref=${GITHUB_BRANCH}`;
            
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        function getFileIcon(type, name) {
            if (type === 'dir') {
                return `<svg class="file-icon folder-icon" viewBox="0 0 16 16">
                    <path d="M1.75 1A1.75 1.75 0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0016 13.25v-8.5A1.75 1.75 0 0014.25 3H7.5a.25.25 0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"></path>
                </svg>`;
            } else {
                return `<svg class="file-icon file-icon-generic" viewBox="0 0 16 16">
                    <path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0113.25 16h-9.5A1.75 1.75 0 012 14.25V1.75zm1.75-.25a.25.25 0 00-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 00.25-.25V6h-2.75A1.75 1.75 0 019 4.25V1.5H3.75zm6.75.062V4.25c0 .138.112.25.25.25h2.688a.252.252 0 00-.011-.013l-2.914-2.914a.246.246 0 00-.013-.011z"></path>
                </svg>`;
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function updateBreadcrumb(path) {
            const breadcrumb = document.getElementById('breadcrumb');
            const parts = path.split('/').filter(p => p);
            
            let html = '<a href="#" onclick="loadPath(\'\')">üìÅ /</a>';
            let currentPath = '';
            
            for (let i = 0; i < parts.length; i++) {
                currentPath += (i === 0 ? '' : '/') + parts[i];
                html += ` / <a href="#" onclick="loadPath('${currentPath}')">${parts[i]}</a>`;
            }
            
            breadcrumb.innerHTML = html;
        }

        async function loadPath(path = '') {
            currentPath = path;
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '<div class="loading">Loading files...</div>';
            
            try {
                const data = await fetchGitHubAPI(path);
                updateBreadcrumb(path);
                
                // Sort: directories first, then files, both alphabetically
                const sortedData = data.sort((a, b) => {
                    if (a.type !== b.type) {
                        return a.type === 'dir' ? -1 : 1;
                    }
                    return a.name.localeCompare(b.name);
                });
                
                let html = '';
                
                // Add parent directory link if not in root
                if (path) {
                    const parentPath = path.split('/').slice(0, -1).join('/');
                    html += `
                        <div class="file-item">
                            <div class="file-icon">üìÅ</div>
                            <div class="file-name">
                                <a href="#" onclick="loadPath('${parentPath}')">..</a>
                            </div>
                            <div class="file-info">
                                <span>-</span>
                                <span>Parent Directory</span>
                            </div>
                        </div>`;
                }
                
                // Add files and directories
                for (const item of sortedData) {
                    const isDir = item.type === 'dir';
                    const itemPath = path ? `${path}/${item.name}` : item.name;
                    const size = isDir ? '-' : formatFileSize(item.size);
                    const type = isDir ? 'Directory' : 'File';
                    
                    html += `
                        <div class="file-item">
                            ${getFileIcon(item.type, item.name)}
                            <div class="file-name">
                                ${isDir ? 
                                    `<a href="#" onclick="loadPath('${itemPath}')">${item.name}/</a>` :
                                    `<a href="${item.html_url}" target="_blank">${item.name}</a>`
                                }
                            </div>
                            <div class="file-info">
                                <span>${size}</span>
                                <span>${type}</span>
                            </div>
                        </div>`;
                }
                
                fileList.innerHTML = html || '<div class="loading">No files found</div>';
                
            } catch (error) {
                fileList.innerHTML = `
                    <div class="error">
                        <h3>Error loading files</h3>
                        <p>${error.message}</p>
                        <p>Please check that:</p>
                        <ul style="text-align: left; display: inline-block;">
                            <li>The repository exists and is public</li>
                            <li>The username and repository name are correct</li>
                            <li>The branch name is correct</li>
                        </ul>
                    </div>`;
            }
        }

        async function loadRepoInfo() {
            try {
                const response = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}`);
                if (response.ok) {
                    const repo = await response.json();
                    document.getElementById('repoInfo').innerHTML = `
                        <a href="${repo.html_url}" target="_blank" style="color: inherit; text-decoration: none;">
                            ${GITHUB_USERNAME}/${GITHUB_REPO}
                        </a> ‚Ä¢ ${repo.description || 'No description'}
                    `;
                    document.title = `${GITHUB_USERNAME}/${GITHUB_REPO} - File Browser`;
                }
            } catch (error) {
                console.error('Failed to load repo info:', error);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadRepoInfo();
            loadPath();
        });
    </script>
</body>
</html>
